var PureSlider=function(){var s=function(s){var t=arguments.length;if(t<2||null==s)return s;function i(s){var t=[];for(var i in s)s.hasOwnProperty(i)&&t.push(i);return t}for(var e=1;e<t;e++)for(var r=arguments[e],n=i(r),a=0;a<n.length;a++)s[n[a]]=r[n[a]];return s},t={autoplay:!1,laps:3e3,showNav:!0,showBtn:!0,direction:"forward",currentCursorClassName:"ps-current",currentSlideClassName:"ps-current",slideClassName:"ps-slide",slidesClassName:"ps-slides",sliderNavClassName:"ps-slider-nav",prevBtnClassName:"ps-left-nav-btn",prevBtnHtml:"prev",nextBtnClassName:"ps-right-nav-btn",nextBtnHtml:"next",stopOnHover:!0,onBeforeSlideChangeCb:function(){},onAfterSlideChangeCb:function(){},onBeforeStartCb:function(){},onAfterStartCb:function(){},onBeforeStopCb:function(){},onAfterStopCb:function(){},onBeforeInitCb:function(){},onAfterInitCb:function(){}};function i(i){this.options=s({},t,i),this.vars={slider:null,slides:[],sliderNav:null,currentSlide:null,currentCursor:null,currentDefined:!1,cursors:[],index:0,max:0,rotate:!0,interval:null,isStarted:!1,hasNav:!1,prevBtn:null,nextBtn:null,hasBtn:!1,direction:this.options.direction,slidesLaps:[],loader:null}}return i.prototype={init:function(s){this.options.onBeforeInitCb(this),this.vars.slider=s,this.vars.slides=[].slice.call(this.vars.slider.querySelector("."+this.options.slidesClassName).children),this.vars.max=this.vars.slides.length-1,this.createLoader();var t=0,i=this,e=this.vars.slides.length;this.vars.slides.forEach(function(s,r){var n=document.createElement("img");n.addEventListener("load",function(s){n=null,++t==e&&i.initAfterLoading()}),n.src=getComputedStyle(s).backgroundImage.slice(4,-1).replace(/"/g,"")})},createLoader:function(){this.vars.loader=document.createElement("div"),this.vars.loader.innerHTML='<div class="ps-double-bounce1"></div><div class="ps-double-bounce2"></div>',this.vars.loader.classList.add("ps-loader"),this.vars.slider.appendChild(this.vars.loader)},destroyLoader:function(){this.vars.slider.removeChild(this.vars.loader),this.vars.loader=null},initAfterLoading:function(){this.destroyLoader(),this.vars.slides.forEach(function(s,t){s.classList.contains(this.options.currentSlideClassName)&&(this.vars.currentDefined?s.classList.remove(this.options.currentSlideClassName):(this.vars.currentDefined=!0,this.vars.index=t,this.vars.currentSlide=s)),s.hasAttribute("data-slide-laps")?this.vars.slidesLaps.push(1e3*parseInt(s.getAttribute("data-slide-laps"))):this.vars.slidesLaps.push(this.options.laps)},this),this.vars.currentDefined||(this.vars.slides[0].classList.add(this.options.currentSlideClassName),this.vars.currentSlide=this.vars.slides[0]),this.options.showBtn&&(this.buildBtn(),this.vars.hasBtn&&this.initBtnEvents()),this.options.showNav&&this.buildNav(),this.options.autoplay&&(this.vars.rotate=!0),this.setStopOnHover(),this.start(),this.options.onAfterInitCb(this)},setStopOnHover:function(){if(this.options.stopOnHover&&this.options.autoplay){var s=this;this.vars.slider.addEventListener("mouseenter",function(t){t.preventDefault(),s.stop()}),this.vars.slider.addEventListener("mouseleave",function(t){t.preventDefault();var i=window.setTimeout(function(){window.clearTimeout(i),"forward"===s.vars.direction?s.next(!0):s.prev(!0)},s.options.laps/2)})}},buildBtn:function(){this.vars.prevBtn=document.createElement("button"),this.vars.prevBtn.innerHTML=this.options.prevBtnHtml,this.vars.prevBtn.classList.add(this.options.prevBtnClassName),this.vars.slider.appendChild(this.vars.prevBtn),this.vars.nextBtn=document.createElement("button"),this.vars.nextBtn.innerHTML=this.options.nextBtnHtml,this.vars.nextBtn.classList.add(this.options.nextBtnClassName),this.vars.slider.appendChild(this.vars.nextBtn),this.vars.hasBtn=!0},buildNav:function(){var s=document.createElement("div");s.classList.add(this.options.sliderNavClassName);var t=document.createElement("ul");this.vars.slides.forEach(function(s,i){var e=document.createElement("li"),r=document.createElement("a");s.classList.contains(this.options.currentSlideClassName)&&(r.classList.add(this.options.currentCursorClassName),this.vars.currentCursor=r,this.vars.index=i),r.addEventListener("click",this.onClickCursorEvent.bind(this)),this.vars.cursors.push(r),e.appendChild(r),t.appendChild(e)},this),s.appendChild(t),this.vars.slider.appendChild(s),this.vars.hasNav=!0},initBtnEvents:function(){var s=this;this.vars.nextBtn.addEventListener("click",function(t){t.preventDefault(),s.next()}),this.vars.prevBtn.addEventListener("click",function(t){t.preventDefault(),s.prev()})},onClickCursorEvent:function(s){s.preventDefault(),this.stop();var t=s.target,i=this.vars.cursors.indexOf(t);this.gotoSlide(i),this.start()},gotoSlide:function(s){null!==s&&void 0!=s||(s=this.vars.index),this.vars.slides[s]&&this.vars.currentSlide!==this.vars.slides[s]&&(this.vars.index=s,this.vars.hasNav&&(this.vars.currentCursor.classList.remove(this.options.currentCursorClassName),this.vars.currentCursor=this.vars.cursors[this.vars.index],this.vars.currentCursor.classList.add(this.options.currentCursorClassName)),this.vars.currentSlide.classList.remove(this.options.currentSlideClassName),this.vars.currentSlide=this.vars.slides[this.vars.index],this.vars.currentSlide.classList.add(this.options.currentSlideClassName))},next:function(s){this.stop(),null!==s&&void 0!=s||(s=this.vars.rotate),this.vars.index+=1,this.vars.index>this.vars.max&&(this.vars.index=!0===s?0:this.vars.max),this.gotoSlide(),this.start()},prev:function(s){this.stop(),null!==s&&void 0!=s||(s=this.vars.rotate),this.vars.index-=1,this.vars.index<0&&(this.vars.index=!0===s?this.vars.max:0),this.gotoSlide(),this.start()},start:function(){if(this.options.autoplay){this.options.onBeforeStartCb(this),this.vars.isStarted=!0;var s=this;this.vars.interval=window.setInterval(function(){"forward"===s.vars.direction?s.next(s.vars.rotate):s.prev(s.vars.rotate),s.options.onAfterStartCb(this)},this.vars.slidesLaps[this.vars.index])}},stop:function(){this.options.onBeforeStopCb(this),this.vars.isStarted=!1,null!=this.vars.interval&&(window.clearInterval(this.vars.interval),this.vars.interval=null),this.options.onAfterStopCb(this)}},i}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlB1cmVTbGlkZXIuanMiXSwibmFtZXMiOlsiUHVyZVNsaWRlciIsIl9leHRlbmQiLCJvYmoiLCJsZW5ndGgiLCJhcmd1bWVudHMiLCJhbGxLZXlzIiwia2V5cyIsInByb3AiLCJoYXNPd25Qcm9wZXJ0eSIsInB1c2giLCJpbmRleCIsInNvdXJjZU9iaiIsImkiLCJERUZBVUxUUyIsImF1dG9wbGF5IiwibGFwcyIsInNob3dOYXYiLCJzaG93QnRuIiwiZGlyZWN0aW9uIiwiY3VycmVudEN1cnNvckNsYXNzTmFtZSIsImN1cnJlbnRTbGlkZUNsYXNzTmFtZSIsInNsaWRlQ2xhc3NOYW1lIiwic2xpZGVzQ2xhc3NOYW1lIiwic2xpZGVyTmF2Q2xhc3NOYW1lIiwicHJldkJ0bkNsYXNzTmFtZSIsInByZXZCdG5IdG1sIiwibmV4dEJ0bkNsYXNzTmFtZSIsIm5leHRCdG5IdG1sIiwic3RvcE9uSG92ZXIiLCJvbkJlZm9yZVNsaWRlQ2hhbmdlQ2IiLCJvbkFmdGVyU2xpZGVDaGFuZ2VDYiIsIm9uQmVmb3JlU3RhcnRDYiIsIm9uQWZ0ZXJTdGFydENiIiwib25CZWZvcmVTdG9wQ2IiLCJvbkFmdGVyU3RvcENiIiwib25CZWZvcmVJbml0Q2IiLCJvbkFmdGVySW5pdENiIiwib3B0aW9ucyIsInRoaXMiLCJ2YXJzIiwic2xpZGVyIiwic2xpZGVzIiwic2xpZGVyTmF2IiwiY3VycmVudFNsaWRlIiwiY3VycmVudEN1cnNvciIsImN1cnJlbnREZWZpbmVkIiwiY3Vyc29ycyIsIm1heCIsInJvdGF0ZSIsImludGVydmFsIiwiaXNTdGFydGVkIiwiaGFzTmF2IiwicHJldkJ0biIsIm5leHRCdG4iLCJoYXNCdG4iLCJzbGlkZXNMYXBzIiwibG9hZGVyIiwicHJvdG90eXBlIiwiaW5pdCIsImVsZW1lbnQiLCJzbGljZSIsImNhbGwiLCJxdWVyeVNlbGVjdG9yIiwiY2hpbGRyZW4iLCJjcmVhdGVMb2FkZXIiLCJ0b3RhbExvYWRlZCIsInNlbGYiLCJ0b3RhbFRvTG9hZCIsImZvckVhY2giLCJpdGVtIiwiaWR4IiwiaW1nIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJpbml0QWZ0ZXJMb2FkaW5nIiwic3JjIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImJhY2tncm91bmRJbWFnZSIsInJlcGxhY2UiLCJpbm5lckhUTUwiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImRlc3Ryb3lMb2FkZXIiLCJyZW1vdmVDaGlsZCIsImNvbnRhaW5zIiwicmVtb3ZlIiwiaGFzQXR0cmlidXRlIiwicGFyc2VJbnQiLCJnZXRBdHRyaWJ1dGUiLCJidWlsZEJ0biIsImluaXRCdG5FdmVudHMiLCJidWlsZE5hdiIsInNldFN0b3BPbkhvdmVyIiwic3RhcnQiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInN0b3AiLCJ0byIsIndpbmRvdyIsInNldFRpbWVvdXQiLCJjbGVhclRpbWVvdXQiLCJuZXh0IiwicHJldiIsImRpdiIsInVsIiwibGkiLCJhIiwib25DbGlja0N1cnNvckV2ZW50IiwiYmluZCIsInQiLCJ0YXJnZXQiLCJpbmRleE9mIiwiZ290b1NsaWRlIiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxXQUFhLFdBQ2IsSUFBSUMsRUFBVSxTQUFVQyxHQUNwQixJQUFJQyxFQUFTQyxVQUFVRCxPQUN2QixHQUFJQSxFQUFTLEdBQVksTUFBUEQsRUFDZCxPQUFPQSxFQUVYLFNBQVNHLEVBQVFILEdBQ2IsSUFBSUksS0FDSixJQUFLLElBQUlDLEtBQVFMLEVBQ1RBLEVBQUlNLGVBQWVELElBQ25CRCxFQUFLRyxLQUFLRixHQUdsQixPQUFPRCxFQUdYLElBQUssSUFBSUksRUFBUSxFQUFHQSxFQUFRUCxFQUFRTyxJQUdoQyxJQUFLLElBRkRDLEVBQVlQLFVBQVVNLEdBQ3RCSixFQUFPRCxFQUFRTSxHQUNWQyxFQUFJLEVBQUdBLEVBQUlOLEVBQUtILE9BQVFTLElBQzdCVixFQUFJSSxFQUFLTSxJ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LFNBQVV6RCxHQUNaVixLQUFLNkQsT0FDVSxPQUFYbkQsUUFBQUEsR0FBbUJBLElBQ25CQSxFQUFTVixLQUFLQyxLQUFLUyxRQUV2QlYsS0FBS0MsS0FBSzdCLE9BQVMsRUFDZjRCLEtBQUtDLEtBQUs3QixNQUFRLElBRWQ0QixLQUFLQyxLQUFLN0IsT0FBQUEsSUFEVnNDLEVBQ2tCVixLQUFLQyxLQUFLUSxJQUVWLEdBRzFCVCxLQUFLNkUsWUFDTDdFLEtBQUswRCxTQUVUQSxNQUFPLFdBQ0gsR0FBSzFELEtBQUtELFFBQVF2QixTQUFsQixDQUdBd0IsS0FBS0QsUUFBUU4sZ0JBQWdCTyxNQUM3QkEsS0FBS0MsS0FBS1csV0FBQUEsRUFDVixJQUFJZ0IsRUFBTzVCLEtBQ1hBLEtBQUtDLEtBQUtVLFNBQVdvRCxPQUFPZSxZQUFZLFdBQ1IsWUFBeEJsRCxFQUFLM0IsS0FBS3JCLFVBQ1ZnRCxFQUFLc0MsS0FBS3RDLEVBQUszQixLQUFLUyxRQUVwQmtCLEVBQUt1QyxLQUFLdkMsRUFBSzNCLEtBQUtTLFFBRXhCa0IsRUFBSzdCLFFBQVFMLGVBQWVNLE9BQzdCQSxLQUFLQyxLQUFLZ0IsV0FBV2pCLEtBQUtDLEtBQUs3QixVQUV0Q3lGLEtBQU0sV0FDRjdELEtBQUtELFFBQVFKLGVBQWVLLE1BQzVCQSxLQUFLQyxLQUFLVyxXQUFBQSxFQUNnQixNQUF0QlosS0FBS0MsS0FBS1UsV0FDVm9ELE9BQU9nQixjQUFjL0UsS0FBS0MsS0FBS1UsVUFDL0JYLEtBQUtDLEtBQUtVLFNBQVcsTUFFekJYLEtBQUtELFFBQVFILGNBQWNJLFFBRzVCdEMsRUE3U00iLCJmaWxlIjoiUHVyZVNsaWRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBQdXJlU2xpZGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgX2V4dGVuZCA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICAgIGlmIChsZW5ndGggPCAyIHx8IG9iaiA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGFsbEtleXMob2JqKSB7XG4gICAgICAgICAgICB2YXIga2V5cyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KHByb3ApKSB7XG4gICAgICAgICAgICAgICAgICAgIGtleXMucHVzaChwcm9wKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ga2V5cztcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGluZGV4ID0gMTsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2VPYmogPSBhcmd1bWVudHNbaW5kZXhdLFxuICAgICAgICAgICAgICAgIGtleXMgPSBhbGxLZXlzKHNvdXJjZU9iaik7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBvYmpba2V5c1tpXV0gPSBzb3VyY2VPYmpba2V5c1tpXV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9O1xuICAgIHZhciBERUZBVUxUUyA9IHtcbiAgICAgICAgYXV0b3BsYXk6IGZhbHNlLFxuICAgICAgICBsYXBzOiAzMDAwLFxuICAgICAgICBzaG93TmF2OiB0cnVlLFxuICAgICAgICBzaG93QnRuOiB0cnVlLFxuICAgICAgICBkaXJlY3Rpb246ICdmb3J3YXJkJywgLy8gYmFja3dhcmQsXG4gICAgICAgIGN1cnJlbnRDdXJzb3JDbGFzc05hbWU6ICdwcy1jdXJyZW50JyxcbiAgICAgICAgY3VycmVudFNsaWRlQ2xhc3NOYW1lOiAncHMtY3VycmVudCcsXG4gICAgICAgIHNsaWRlQ2xhc3NOYW1lOiAncHMtc2xpZGUnLFxuICAgICAgICBzbGlkZXNDbGFzc05hbWU6ICdwcy1zbGlkZXMnLFxuICAgICAgICBzbGlkZXJOYXZDbGFzc05hbWU6ICdwcy1zbGlkZXItbmF2JyxcbiAgICAgICAgcHJldkJ0bkNsYXNzTmFtZTogJ3BzLWxlZnQtbmF2LWJ0bicsXG4gICAgICAgIHByZXZCdG5IdG1sOiAncHJldicsXG4gICAgICAgIG5leHRCdG5DbGFzc05hbWU6ICdwcy1yaWdodC1uYXYtYnRuJyxcbiAgICAgICAgbmV4dEJ0bkh0bWw6ICduZXh0JyxcbiAgICAgICAgc3RvcE9uSG92ZXI6IHRydWUsXG4gICAgICAgIG9uQmVmb3JlU2xpZGVDaGFuZ2VDYjogZnVuY3Rpb24gKCkge1xuICAgICAgICB9LFxuICAgICAgICBvbkFmdGVyU2xpZGVDaGFuZ2VDYjogZnVuY3Rpb24gKCkge1xuICAgICAgICB9LFxuICAgICAgICBvbkJlZm9yZVN0YXJ0Q2I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfSxcbiAgICAgICAgb25BZnRlclN0YXJ0Q2I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfSxcbiAgICAgICAgb25CZWZvcmVTdG9wQ2I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfSxcbiAgICAgICAgb25BZnRlclN0b3BDYjogZnVuY3Rpb24gKCkge1xuICAgICAgICB9LFxuICAgICAgICBvbkJlZm9yZUluaXRDYjogZnVuY3Rpb24gKCkge1xuICAgICAgICB9LFxuICAgICAgICBvbkFmdGVySW5pdENiOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGZ1bmN0aW9uIFB1cmVTbGlkZXIob3B0aW9ucykge1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBfZXh0ZW5kKHt9LCBERUZBVUxUUywgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMudmFycyA9IHtcbiAgICAgICAgICAgIHNsaWRlcjogbnVsbCxcbiAgICAgICAgICAgIHNsaWRlczogW10sXG4gICAgICAgICAgICBzbGlkZXJOYXY6IG51bGwsXG4gICAgICAgICAgICBjdXJyZW50U2xpZGU6IG51bGwsXG4gICAgICAgICAgICBjdXJyZW50Q3Vyc29yOiBudWxsLFxuICAgICAgICAgICAgY3VycmVudERlZmluZWQ6IGZhbHNlLFxuICAgICAgICAgICAgY3Vyc29yczogW10sXG4gICAgICAgICAgICBpbmRleDogMCxcbiAgICAgICAgICAgIG1heDogMCxcbiAgICAgICAgICAgIHJvdGF0ZTogdHJ1ZSxcbiAgICAgICAgICAgIGludGVydmFsOiBudWxsLFxuICAgICAgICAgICAgaXNTdGFydGVkOiBmYWxzZSxcbiAgICAgICAgICAgIGhhc05hdjogZmFsc2UsXG4gICAgICAgICAgICBwcmV2QnRuOiBudWxsLFxuICAgICAgICAgICAgbmV4dEJ0bjogbnVsbCxcbiAgICAgICAgICAgIGhhc0J0bjogZmFsc2UsXG4gICAgICAgICAgICBkaXJlY3Rpb246IHRoaXMub3B0aW9ucy5kaXJlY3Rpb24sXG4gICAgICAgICAgICBzbGlkZXNMYXBzOiBbXSxcbiAgICAgICAgICAgIGxvYWRlcjogbnVsbFxuICAgICAgICB9XG4gICAgfVxuXG5cblxuICAgIFB1cmVTbGlkZXIucHJvdG90eXBlID0ge1xuICAgICAgICBpbml0OiBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLm9uQmVmb3JlSW5pdENiKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlciA9IGVsZW1lbnQ7XG4gICAgICAgICAgICB0aGlzLnZhcnMuc2xpZGVzID1cbiAgICAgICAgICAgICAgICBbXS5zbGljZS5jYWxsKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcnMuc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5vcHRpb25zLnNsaWRlc0NsYXNzTmFtZSkuY2hpbGRyZW5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy52YXJzLm1heCA9ICh0aGlzLnZhcnMuc2xpZGVzLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVMb2FkZXIoKTtcbiAgICAgICAgICAgIHZhciB0b3RhbExvYWRlZCA9IDAsIHNlbGYgPSB0aGlzLCB0b3RhbFRvTG9hZCA9IHRoaXMudmFycy5zbGlkZXMubGVuZ3RoO1xuICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpZHgpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgICAgICAgICAgICAgaW1nLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBpbWcgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB0b3RhbExvYWRlZCsrO1xuICAgICAgICAgICAgICAgICAgICBpZiAodG90YWxMb2FkZWQgPT0gdG90YWxUb0xvYWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaW5pdEFmdGVyTG9hZGluZygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaW1nLnNyYyA9IGdldENvbXB1dGVkU3R5bGUoaXRlbSkuYmFja2dyb3VuZEltYWdlLnNsaWNlKDQsIC0xKS5yZXBsYWNlKC9cIi9nLCBcIlwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVMb2FkZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMudmFycy5sb2FkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIHRoaXMudmFycy5sb2FkZXIuaW5uZXJIVE1MID0gJzxkaXYgY2xhc3M9XCJwcy1kb3VibGUtYm91bmNlMVwiPjwvZGl2PjxkaXYgY2xhc3M9XCJwcy1kb3VibGUtYm91bmNlMlwiPjwvZGl2Pic7XG4gICAgICAgICAgICB0aGlzLnZhcnMubG9hZGVyLmNsYXNzTGlzdC5hZGQoJ3BzLWxvYWRlcicpO1xuICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlci5hcHBlbmRDaGlsZCh0aGlzLnZhcnMubG9hZGVyKTtcbiAgICAgICAgfSxcbiAgICAgICAgZGVzdHJveUxvYWRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlci5yZW1vdmVDaGlsZCh0aGlzLnZhcnMubG9hZGVyKTtcbiAgICAgICAgICAgIHRoaXMudmFycy5sb2FkZXIgPSBudWxsO1xuICAgICAgICB9LFxuICAgICAgICBpbml0QWZ0ZXJMb2FkaW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3lMb2FkZXIoKTtcbiAgICAgICAgICAgIHRoaXMudmFycy5zbGlkZXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaWR4KSB7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMub3B0aW9ucy5jdXJyZW50U2xpZGVDbGFzc05hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhcnMuY3VycmVudERlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLm9wdGlvbnMuY3VycmVudFNsaWRlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJzLmN1cnJlbnREZWZpbmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFycy5pbmRleCA9IGlkeDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFycy5jdXJyZW50U2xpZGUgPSBpdGVtO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpdGVtLmhhc0F0dHJpYnV0ZSgnZGF0YS1zbGlkZS1sYXBzJykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlc0xhcHMucHVzaCgocGFyc2VJbnQoaXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2xpZGUtbGFwcycpKSAqIDEwMDApKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcnMuc2xpZGVzTGFwcy5wdXNoKHRoaXMub3B0aW9ucy5sYXBzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgIGlmICghdGhpcy52YXJzLmN1cnJlbnREZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlc1swXS5jbGFzc0xpc3QuYWRkKHRoaXMub3B0aW9ucy5jdXJyZW50U2xpZGVDbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgIHRoaXMudmFycy5jdXJyZW50U2xpZGUgPSB0aGlzLnZhcnMuc2xpZGVzWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zaG93QnRuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5idWlsZEJ0bigpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhcnMuaGFzQnRuKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdEJ0bkV2ZW50cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd05hdikge1xuICAgICAgICAgICAgICAgIHRoaXMuYnVpbGROYXYoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuYXV0b3BsYXkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhcnMucm90YXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2V0U3RvcE9uSG92ZXIoKTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnQoKTtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbkFmdGVySW5pdENiKHRoaXMpO1xuICAgICAgICB9LFxuICAgICAgICBzZXRTdG9wT25Ib3ZlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zdG9wT25Ib3ZlciAmJiB0aGlzLm9wdGlvbnMuYXV0b3BsYXkpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zdG9wKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRvID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0byk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi52YXJzLmRpcmVjdGlvbiA9PT0gJ2ZvcndhcmQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5uZXh0KHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnByZXYodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sIHNlbGYub3B0aW9ucy5sYXBzIC8gMik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGJ1aWxkQnRuOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnZhcnMucHJldkJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICAgICAgdGhpcy52YXJzLnByZXZCdG4uaW5uZXJIVE1MID0gdGhpcy5vcHRpb25zLnByZXZCdG5IdG1sO1xuICAgICAgICAgICAgdGhpcy52YXJzLnByZXZCdG4uY2xhc3NMaXN0LmFkZCh0aGlzLm9wdGlvbnMucHJldkJ0bkNsYXNzTmFtZSk7XG4gICAgICAgICAgICB0aGlzLnZhcnMuc2xpZGVyLmFwcGVuZENoaWxkKHRoaXMudmFycy5wcmV2QnRuKTtcbiAgICAgICAgICAgIHRoaXMudmFycy5uZXh0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgICAgICB0aGlzLnZhcnMubmV4dEJ0bi5pbm5lckhUTUwgPSB0aGlzLm9wdGlvbnMubmV4dEJ0bkh0bWw7XG4gICAgICAgICAgICB0aGlzLnZhcnMubmV4dEJ0bi5jbGFzc0xpc3QuYWRkKHRoaXMub3B0aW9ucy5uZXh0QnRuQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgIHRoaXMudmFycy5zbGlkZXIuYXBwZW5kQ2hpbGQodGhpcy52YXJzLm5leHRCdG4pO1xuICAgICAgICAgICAgdGhpcy52YXJzLmhhc0J0biA9IHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGJ1aWxkTmF2OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZCh0aGlzLm9wdGlvbnMuc2xpZGVyTmF2Q2xhc3NOYW1lKTtcbiAgICAgICAgICAgIHZhciB1bCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG4gICAgICAgICAgICB0aGlzLnZhcnMuc2xpZGVzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGlkeCkge1xuICAgICAgICAgICAgICAgIHZhciBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgICAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMub3B0aW9ucy5jdXJyZW50U2xpZGVDbGFzc05hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGEuY2xhc3NMaXN0LmFkZCh0aGlzLm9wdGlvbnMuY3VycmVudEN1cnNvckNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFycy5jdXJyZW50Q3Vyc29yID0gYTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJzLmluZGV4ID0gaWR4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vbkNsaWNrQ3Vyc29yRXZlbnQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgdGhpcy52YXJzLmN1cnNvcnMucHVzaChhKTtcbiAgICAgICAgICAgICAgICBsaS5hcHBlbmRDaGlsZChhKTtcbiAgICAgICAgICAgICAgICB1bC5hcHBlbmRDaGlsZChsaSk7XG4gICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgIGRpdi5hcHBlbmRDaGlsZCh1bCk7XG4gICAgICAgICAgICB0aGlzLnZhcnMuc2xpZGVyLmFwcGVuZENoaWxkKGRpdik7XG4gICAgICAgICAgICB0aGlzLnZhcnMuaGFzTmF2ID0gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgaW5pdEJ0bkV2ZW50czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy52YXJzLm5leHRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgc2VsZi5uZXh0KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMudmFycy5wcmV2QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHNlbGYucHJldigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uQ2xpY2tDdXJzb3JFdmVudDogZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgICAgIHZhciB0ID0gZXZ0LnRhcmdldDtcbiAgICAgICAgICAgIHZhciBpZHggPSB0aGlzLnZhcnMuY3Vyc29ycy5pbmRleE9mKHQpO1xuICAgICAgICAgICAgdGhpcy5nb3RvU2xpZGUoaWR4KTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZ290b1NsaWRlOiBmdW5jdGlvbiAoaWR4KSB7XG4gICAgICAgICAgICBpZiAoaWR4ID09PSBudWxsIHx8IGlkeCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZHggPSB0aGlzLnZhcnMuaW5kZXg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy52YXJzLnNsaWRlc1tpZHhdICYmIHRoaXMudmFycy5jdXJyZW50U2xpZGUgIT09IHRoaXMudmFycy5zbGlkZXNbaWR4XSkge1xuICAgICAgICAgICAgICAgIHRoaXMudmFycy5pbmRleCA9IGlkeDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy52YXJzLmhhc05hdikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcnMuY3VycmVudEN1cnNvci5jbGFzc0xpc3QucmVtb3ZlKHRoaXMub3B0aW9ucy5jdXJyZW50Q3Vyc29yQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJzLmN1cnJlbnRDdXJzb3IgPSB0aGlzLnZhcnMuY3Vyc29yc1t0aGlzLnZhcnMuaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcnMuY3VycmVudEN1cnNvci5jbGFzc0xpc3QuYWRkKHRoaXMub3B0aW9ucy5jdXJyZW50Q3Vyc29yQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy52YXJzLmN1cnJlbnRTbGlkZS5jbGFzc0xpc3QucmVtb3ZlKHRoaXMub3B0aW9ucy5jdXJyZW50U2xpZGVDbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgIHRoaXMudmFycy5jdXJyZW50U2xpZGUgPSB0aGlzLnZhcnMuc2xpZGVzW3RoaXMudmFycy5pbmRleF07XG4gICAgICAgICAgICAgICAgdGhpcy52YXJzLmN1cnJlbnRTbGlkZS5jbGFzc0xpc3QuYWRkKHRoaXMub3B0aW9ucy5jdXJyZW50U2xpZGVDbGFzc05hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAocm90YXRlKSB7XG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgICAgIGlmIChyb3RhdGUgPT09IG51bGwgfHwgcm90YXRlID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJvdGF0ZSA9IHRoaXMudmFycy5yb3RhdGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudmFycy5pbmRleCArPSAxO1xuICAgICAgICAgICAgaWYgKHRoaXMudmFycy5pbmRleCA+IHRoaXMudmFycy5tYXgpIHtcbiAgICAgICAgICAgICAgICBpZiAocm90YXRlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFycy5pbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJzLmluZGV4ID0gdGhpcy52YXJzLm1heDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmdvdG9TbGlkZSgpO1xuICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xuICAgICAgICB9LFxuICAgICAgICBwcmV2OiBmdW5jdGlvbiAocm90YXRlKSB7XG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgICAgIGlmIChyb3RhdGUgPT09IG51bGwgfHwgcm90YXRlID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJvdGF0ZSA9IHRoaXMudmFycy5yb3RhdGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudmFycy5pbmRleCAtPSAxO1xuICAgICAgICAgICAgaWYgKHRoaXMudmFycy5pbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICBpZiAocm90YXRlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFycy5pbmRleCA9IHRoaXMudmFycy5tYXg7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJzLmluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmdvdG9TbGlkZSgpO1xuICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xuICAgICAgICB9LFxuICAgICAgICBzdGFydDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuYXV0b3BsYXkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMub25CZWZvcmVTdGFydENiKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy52YXJzLmlzU3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLnZhcnMuaW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLnZhcnMuZGlyZWN0aW9uID09PSAnZm9yd2FyZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5uZXh0KHNlbGYudmFycy5yb3RhdGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYucHJldihzZWxmLnZhcnMucm90YXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2VsZi5vcHRpb25zLm9uQWZ0ZXJTdGFydENiKHRoaXMpO1xuICAgICAgICAgICAgfSwgdGhpcy52YXJzLnNsaWRlc0xhcHNbdGhpcy52YXJzLmluZGV4XSk7XG4gICAgICAgIH0sXG4gICAgICAgIHN0b3A6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbkJlZm9yZVN0b3BDYih0aGlzKTtcbiAgICAgICAgICAgIHRoaXMudmFycy5pc1N0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnZhcnMuaW50ZXJ2YWwgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMudmFycy5pbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgdGhpcy52YXJzLmludGVydmFsID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbkFmdGVyU3RvcENiKHRoaXMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gUHVyZVNsaWRlcjtcbn0pKCk7Il19
